<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Devis — R3D PRINT CI</title>
  <meta name="description" content="Demande de devis rapide — 3 étapes — envoi WhatsApp." />
  <style>
    :root{--bg:#f7f6f3;--ink:#0f1115;--panel:#fff;--muted:#5a5e66;--stroke:#e7e3da;--gold:#bfa06a;--radius:16px;--container:1120px;--shadow:0 10px 30px rgba(15,17,21,.06)}
    *{box-sizing:border-box} html,body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial}
    a{text-decoration:none;color:inherit} img{max-width:100%}
    header{border-bottom:1px solid var(--stroke);background:#f7f6f3cc}
    .bar{max-width:var(--container);margin:auto;padding:12px 28px;display:flex;gap:16px;align-items:center;justify-content:space-between}
    .brand{display:flex;gap:12px;align-items:center}.brand img{width:60px;height:60px;object-fit:contain}
    .btn{display:inline-flex;gap:10px;align-items:center;justify-content:center;padding:10px 16px;border-radius:999px;border:1px solid #cfc7b6;background:#fff;color:#111;font-weight:700;cursor:pointer}
    .btn.gold{background:linear-gradient(180deg,#c7ab78,#b08e57);color:#fff;border-color:#a07f48}
    .container{max-width:var(--container);margin:auto;padding:28px}
    .h1{font-size:clamp(26px,5.4vw,40px);margin:0 0 6px}
    .lead{color:var(--muted);max-width:860px}
    .wizard{margin-top:16px;background:var(--panel);border:1px solid var(--stroke);border-radius:14px;box-shadow:var(--shadow);padding:16px}
    .steps{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px}
    .step{padding:6px 10px;border:1px solid var(--stroke);border-radius:999px;background:#fff}
    .step.active{border-color:#bfa06a;box-shadow:0 0 0 2px #eadfc8 inset}
    form{display:grid;gap:12px}
    .row{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
    label{font-weight:700;font-size:14px}
    input, select, textarea{width:100%;border-radius:12px;border:1px solid var(--stroke);background:#fff;color:#111;padding:10px 12px}
    input[type=number]{appearance:textfield}
    input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{appearance:none;margin:0}
    textarea{min-height:110px;resize:vertical}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:4px}
    .back{margin-top:18px;display:flex;gap:10px}
    .hint{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <header>
    <div class="bar">
      <div class="brand">
        <img src="assets/logo.png" onerror="this.onerror=null;this.src='assets/logo.jpg';" alt="R3D PRINT CI">
        <strong>R3D PRINT CI</strong>
      </div>
      <nav style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
        <a class="btn" href="index.html">Accueil</a>
        <a class="btn" href="services.html">Services</a>
        <a class="btn" href="realisations.html">Réalisations</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <h1 class="h1">Demande de devis (3 étapes)</h1>
    <p class="lead">Remplis l’essentiel, vérifie, puis envoie : le message s’ouvre automatiquement dans WhatsApp.</p>

    <section class="wizard">
      <div class="steps">
        <span class="step active" id="s1">1 • Projet</span>
        <span class="step" id="s2">2 • Détails</span>
        <span class="step" id="s3">3 • Contacts</span>
      </div>

      <form id="quoteForm">
        <!-- ÉTAPE 1 -->
        <div class="stage" data-stage="1">
          <div class="row">
            <div><label for="qNature">Nature de l’objet</label><input id="qNature" type="text" placeholder="Trophée, plaque, pièce fonctionnelle…" required></div>
            <div>
              <label>Dimensions</label>
              <div class="row" style="grid-template-columns:repeat(4,1fr)">
                <input id="dimL" type="number" inputmode="decimal" min="0" step="0.1" placeholder="L" required>
                <input id="dimW" type="number" inputmode="decimal" min="0" step="0.1" placeholder="l">
                <input id="dimH" type="number" inputmode="decimal" min="0" step="0.1" placeholder="h">
                <select id="dimUnit"><option value="mm">mm</option><option value="cm">cm</option></select>
              </div>
              <div class="hint">Conversion automatique en millimètres.</div>
            </div>
            <div><label for="qStorage">Environnement</label>
              <select id="qStorage"><option value="">Sélectionner…</option><option>Intérieur</option><option>Extérieur</option><option>Mixte</option></select>
            </div>
          </div>
        </div>

        <!-- ÉTAPE 2 -->
        <div class="stage" data-stage="2" hidden>
          <div class="row">
            <div><label for="qMaterial">Matière / Technologie</label>
              <select id="qMaterial">
                <option value="">À conseiller</option>
                <option>FDM — PLA</option><option>FDM — PETG</option><option>FDM — ASA</option>
                <option>Laser — Bois</option><option>Laser — Acrylique</option><option>Laser — Métal (anodisé/inox)</option>
              </select>
            </div>
            <div><label for="qColors">Couleurs</label><input id="qColors" type="text" placeholder="Ex : Noir / Or / Argent"></div>
            <div><label for="qQty">Quantité</label><input id="qQty" type="number" inputmode="numeric" min="1" step="1" placeholder="1"></div>
          </div>
          <div class="row">
            <div><label for="qDeadline">Délai souhaité</label><input id="qDeadline" type="text" placeholder="Ex : 3 jours / date précise"></div>
            <div><label for="qBudget">Budget indicatif (CFA)</label><input id="qBudget" type="number" inputmode="numeric" min="0" step="1000" placeholder="Ex : 30000"></div>
            <div><label for="qLink">Lien fichier (Drive/WeTransfer)</label><input id="qLink" type="url" placeholder="URL de votre fichier ou croquis"></div>
          </div>
          <div><label for="qNotes">Notes / précisions</label><textarea id="qNotes" placeholder="Contexte d’usage, finitions, contraintes, inspiration…"></textarea></div>
        </div>

        <!-- ÉTAPE 3 -->
        <div class="stage" data-stage="3" hidden>
          <div class="row">
            <div><label for="qName">Nom / Société</label><input id="qName" type="text" placeholder="Ex : Monsieur K., Société X"></div>
            <div><label for="qPhone">Téléphone / WhatsApp</label><input id="qPhone" type="tel" inputmode="tel" placeholder="+225 07 00 00 00 00"></div>
            <div><label for="qEmail">E-mail</label><input id="qEmail" type="email" placeholder="exemple@domaine.com"></div>
          </div>
          <p class="hint">Nous utilisons ces infos uniquement pour vous répondre à propos de ce devis.</p>
        </div>

        <div class="actions">
          <button type="button" class="btn" id="prev" disabled>← Précédent</button>
          <button type="button" class="btn" id="next">Suivant →</button>
          <button type="button" class="btn gold" id="send" hidden>Envoyer sur WhatsApp</button>
          <button type="reset" class="btn">Effacer</button>
        </div>
      </form>
    </section>

    <div class="back">
      <a class="btn" href="index.html">← Accueil</a>
      <a class="btn" href="services.html">Voir nos services</a>
    </div>
  </main>

  <script>
    // Wizard simple
    const stages=[...document.querySelectorAll(".stage")];
    const steps=[document.getElementById("s1"),document.getElementById("s2"),document.getElementById("s3")];
    const prev=document.getElementById("prev"), next=document.getElementById("next"), send=document.getElementById("send");
    let cur=0;
    function render(){
      stages.forEach((st,i)=> st.hidden = i!==cur);
      steps.forEach((sp,i)=> sp.classList.toggle("active", i===cur));
      prev.disabled = cur===0; next.hidden = cur===stages.length-1; send.hidden = !(cur===stages.length-1);
    }
    prev.addEventListener("click",()=>{ if(cur>0){cur--; render();} });
    next.addEventListener("click",()=>{
      if(cur===0){ // validation minimale étape 1
        const nature=document.getElementById("qNature").value.trim();
        const L=document.getElementById("dimL").value.trim();
        const W=document.getElementById("dimW").value.trim();
        const H=document.getElementById("dimH").value.trim();
        if(!nature || !(L||W||H)){ alert("Indique au minimum la nature et une dimension."); return; }
      }
      if(cur<stages.length-1){cur++; render();}
    });
    render();

    // Build WhatsApp message
    function sanitize(s){ return (s||"").toString().trim(); }
    function dimsToMM(){
      const L=parseFloat(document.getElementById("dimL").value)||0;
      const W=parseFloat(document.getElementById("dimW").value)||0;
      const H=parseFloat(document.getElementById("dimH").value)||0;
      const unit=document.getElementById("dimUnit").value;
      const k=(unit==="cm")?10:1; return {L:L*k,W:W*k,H:H*k,unit:"mm"};
    }
    function buildQuoteMessage(){
      const name=sanitize(document.getElementById("qName").value);
      const phone=sanitize(document.getElementById("qPhone").value);
      const email=sanitize(document.getElementById("qEmail").value);
      const nature=sanitize(document.getElementById("qNature").value);
      const env=sanitize(document.getElementById("qStorage").value);
      const colors=sanitize(document.getElementById("qColors").value);
      const material=sanitize(document.getElementById("qMaterial").value);
      const qty=sanitize(document.getElementById("qQty").value);
      const deadline=sanitize(document.getElementById("qDeadline").value);
      const budget=sanitize(document.getElementById("qBudget").value);
      const link=sanitize(document.getElementById("qLink").value);
      const notes=sanitize(document.getElementById("qNotes").value);
      const d=dimsToMM(); const dims=(d.L||d.W||d.H)?`${Math.round(d.L)} × ${Math.round(d.W)} × ${Math.round(d.H)} ${d.unit}`:"";
      const lines=[
        "Bonjour R3D PRINT CI, je souhaite un devis :","",
        name? "• Nom / Société : "+name :"",
        phone? "• Téléphone : "+phone :"",
        email? "• E-mail : "+email :"",
        nature? "• Nature de l'objet : "+nature :"",
        dims? "• Dimensions : "+dims :"",
        env? "• Environnement : "+env :"",
        colors? "• Couleurs : "+colors :"",
        material? "• Matière / Techno : "+material :"",
        qty? "• Quantité : "+qty :"",
        deadline? "• Délai souhaité : "+deadline :"",
        budget? "• Budget indicatif : "+budget+" CFA" :"",
        link? "• Lien fichier : "+link :"",
        notes? "• Notes : "+notes :""
      ].filter(Boolean).join("\n");
      return encodeURIComponent(lines);
    }
    const sendBtn=document.getElementById("send");
    sendBtn.addEventListener("click", ()=>{
      // mini validation contact : au moins un moyen
      const phoneVal=document.getElementById("qPhone").value.trim();
      const emailVal=document.getElementById("qEmail").value.trim();
      if(!phoneVal && !emailVal){ alert("Ajoute un téléphone ou un e-mail pour te joindre."); return; }
      const waNumber="002250757841323".replace(/^00/,"");
      const url="https://wa.me/"+waNumber+"?text="+buildQuoteMessage();
      window.open(url,"_blank");
    });
  </script>
</body>
</html>
